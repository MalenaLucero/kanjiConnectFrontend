<mat-card>
  <h2>Upload new expression</h2>
  <form [formGroup]="form">
    <section class="form-expression-section border-main">
      <div class="expression-container">
        <mat-form-field>
          <mat-label>Expression</mat-label>
          <input matInput formControlName="word" autofocus>
        </mat-form-field>
        <app-accent-button text="Autocomplete"
                        (click)="autocomplete()"
                        [disabled]="!form.get('word')?.valid">
        </app-accent-button>
      </div>
      <div>
        <mat-form-field>
          <mat-label>Reading</mat-label>
          <input matInput formControlName="reading">
        </mat-form-field>
      </div>
    </section>
    <!--ENGLISH MEANING-->
    <section formArrayName="englishMeaning" class="border">
      <ng-container *ngFor="let meaning of englishMeaning.controls; let i = index">
        <div formGroupName="{{ i }}" class="form-section">
          <mat-form-field>
            <mat-label>English Meaning</mat-label>
            <input matInput formControlName="meaning" id="{{'name' + i}}" name="meaning">
          </mat-form-field>
          <button mat-icon-button color="primary"
                  [disabled]="englishMeaning.controls[i].get('meaning')?.value.length === 0 ||
                              englishMeaning.length !== i + 1"
                  (click)="addToFormArray('englishMeaning')">
            <mat-icon>add_circle</mat-icon>
          </button>
          <button mat-icon-button [disabled]="englishMeaning.length === 1" color="warn"
                (click)="deleteFromFormArray('englishMeaning', i)">
            <mat-icon>delete</mat-icon>
          </button>
        </div>
      </ng-container>
    </section>
    <!--JAPANESE MEANING-->
    <section formArrayName="japaneseMeaning" class="border">
      <ng-container *ngFor="let meaning of japaneseMeaning.controls; let i = index">
        <div formGroupName="{{ i }}" class="form-section">
          <mat-form-field>
            <mat-label>Japanese Meaning</mat-label>
            <input matInput formControlName="meaning" id="{{'name' + i}}" name="meaning">
          </mat-form-field>
          <button mat-icon-button color="primary"
                  [disabled]="japaneseMeaning.controls[i].get('meaning')?.value.length === 0 ||
                              japaneseMeaning.length !== i + 1"
                  (click)="addToFormArray('japaneseMeaning')">
            <mat-icon>add_circle</mat-icon>
          </button>
          <button mat-icon-button [disabled]="japaneseMeaning.length === 1" color="warn"
                  (click)="deleteFromFormArray('japaneseMeaning', i)">
            <mat-icon>delete</mat-icon>
          </button>
        </div>
      </ng-container>
    </section>
    <!--EXAMPLE SENTENCES-->
    <section formArrayName="exampleSentences">
      <ng-container *ngFor="let sentence of exampleSentences.controls; let i = index">
        <div formGroupName="{{ i }}" class="sentence-form-section border">
          <div class="form-fields">
            <mat-form-field>
              <mat-label>Example Sentence</mat-label>
              <input matInput formControlName="sentence" id="{{'name' + i}}" name="sentence">
            </mat-form-field>
            <mat-form-field>
              <mat-label>Source</mat-label>
              <input matInput formControlName="source" id="{{'name' + i}}" name="source">
            </mat-form-field>
            <mat-form-field>
              <mat-label>Link</mat-label>
              <input matInput formControlName="link" id="{{'name' + i}}" name="link">
            </mat-form-field>
          </div>
          <div class="buttons">
            <button mat-icon-button color="primary"
                    [disabled]="exampleSentences.controls[i].get('sentence')?.value.length === 0 ||
                    exampleSentences.length !== i + 1"
                    (click)="addToFormArray('exampleSentences')">
              <mat-icon>add_circle</mat-icon>
            </button>
            <button mat-icon-button [disabled]="exampleSentences.length === 1" color="warn"
                    (click)="deleteFromFormArray('exampleSentences', i)">
              <mat-icon>delete</mat-icon>
            </button>
          </div>
        </div>
      </ng-container>
    </section>
    <div class="form-select-group">
      <div class="select">
        <app-jlpt-select formControlName="jlpt"></app-jlpt-select>
      </div>
      <div class="select">
        <app-transitivity-select formControlName="transitivity"></app-transitivity-select>
      </div>
    </div>
    <div class="form-section-full">
      <app-lessons-select formControlName="lesson"></app-lessons-select>
    </div>
    <app-tags-select formControlName="tags"></app-tags-select>
    <div class="m-s-td submit-button">
      <app-main-button (click)="sendData()"
                        text="Add expression"
                        [disabled]="form.invalid">
      </app-main-button>
    </div>
  </form>
</mat-card>
